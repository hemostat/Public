[
["index.html", "GxE Fam Project Preface", " GxE Fam Project Andrey Ziyatdinov 2018-09-05 Preface Links Public version of the book: html, pdf "],
["manuscript.html", "1 Manuscript 1.1 Introduction 1.2 Methods and Analytical Derivations 1.3 Results", " 1 Manuscript Title: Statistical power in GWAS revisited: sample size, genetic relatedness, and gene-by-environment interactions Abstract: Genome-wide association studies (GWAS) have identified thousands of genetic variants associated with complex diseases and heavily rely on increasing the sample size. Recent analyses of biobank-scale genetic data suggest: (i) inclusion of genetically related individuals empowers GWAS (Loh et al. 2018); (ii) the wealth of collected environmental exposures has potential to uncover gene-by-environmental interactions (Young, Wauthier, and Donnelly 2016). However, quantification of GWAS power — the non-centrality parameter (\\(NCP\\)) of association test, which is proportional to the sample size (\\(n\\)) and the variance explained by genetic variant (\\(q^2\\)) — holds only for unrelated individuals. Here, we first expanded it by incorporating individual relationships by linear mixed model. We next studied gene-by-environment interactions, where interaction effect on trait is tested in the presence of marginal genetic effect. In result, the derived formulas have a range of implications. For testing marginal genetic effect, one can quickly assess the power in studies involving related individuals. Because of the potential gain in power for testing gene-by-environment interaction, the formula for interactions will allow optimization of the study design of related individuals. 1.1 Introduction 1.2 Methods and Analytical Derivations 1.2.1 Linear mixed model for genetic association study We consider the following linear mixed model to study the impact of relatedness among individuals on modeling a continuous phenotype \\(y\\). \\[\\begin{equation} y = X \\beta + \\sum_{k=1}^{m}{r_k} + e \\tag{1.1} \\end{equation}\\] where \\(n\\) is the number of individuals, \\(p\\) is the number of covariates or fixed effects, \\(m\\) is the number of structured random effects apart from the residuals errors, \\(y\\) is a phenotype vector of length \\(n\\), \\(X\\) is a matrix of covariates of size \\(n \\times p\\), \\(\\beta\\) is a vector of fixed effects of length \\(p\\). The vectors of random effects \\(r_k\\) and \\(e\\) are mutually uncorrelated and multivariate normally distributed as \\(\\mathcal{N}(0, \\sigma^2_k R_k)\\) and \\(\\mathcal{N}(0, \\sigma^2_r I)\\). The variance-covariance matrices are parametrized with scalar parameters (referred as variance components) and constant matrices of size \\(n \\times n\\) that express relationships among \\(n\\) individuals. The first \\(m\\) random effects \\(r_k\\) are referred here as structured, whereas the last component \\(e\\) is simply the residual errors which are independent and identically distributed. Thus, the phenotype follows a multivariate normal distribution (MVN) and Equation (1.1) can be rewritten: \\[\\begin{equation} y \\sim \\mathcal{N} (X \\beta, V) = \\mathcal{N} (X \\beta, \\sum_{k=1}^{m}{\\sigma_k^2 R_k} + \\sigma_r^2 I) \\tag{1.2} \\end{equation}\\] An assosiation test for a given variable in the matrix \\(X\\) consists in constructing the score test statistic based on the estimates of effect size and its variance, \\(Z = \\hat{\\beta}_x / \\sqrt{var(\\hat{\\beta}_x)}\\). The score follows the standard normal distribution \\(Z \\sim \\mathcal{N}(0, 1)\\), and the \\(\\chi^2\\) test with non-centrality parameter \\(NCP = Z^2 = \\hat{\\beta^2}_x / var(\\hat{\\beta}_x)\\) quantifies the statistical power. We further consider several parameterizations of the model in Equation (1.2) that depend on (i) whether marginal genetic or gene-environment interaction effect is under testing; (ii) whether structured random effects are included or only the residual errors are present. The detailed derivation of the formulas presented next is given in Supplementary Material, Section 2.2. We introduce common assumptions and notations before going further. We assume that all vectors of the phenotype (\\(y\\)) and covariates (columns in the matrix \\(X\\)) are centered. The phenotype vector is additionally standardized (\\(var(y) = 1\\)). The genotype vector \\(x_g\\) is considered as a realization of a vector of random variables \\(\\mathcal{X_g}\\), which is a genotype in \\(n\\) individuals with a minor allele frequency \\(p\\). We denote the distribution \\(\\mathcal{X_g} \\sim (\\mu_g, \\Sigma_g) = (p 1_n, \\delta_g^2 K) = (p 1_n, 2 p (1-p) K)\\), where \\(K\\) is the kinship matrix of size \\(n \\times n\\) (it can be the identity matrix \\(I\\) for genetically unrelated individuals) and \\(1_n\\) is a vector of \\(n\\) ones. 1.2.2 Testing marginal genetic effect The genetic effect on phenotype in unrelated individuals is evaluated under the standard linear model \\(y \\sim \\mathcal{N} (\\mu x_0 + \\beta_g x_g, \\sigma_r^2 I)\\), where \\(x_0 = 1_n\\) is a vector of \\(n\\) ones, \\(\\mu\\) is a mean of the phenotypic values, \\(x_g\\) is a vector of length of the genotypic values, \\(\\beta_g\\) is the effect size of the genotype. The NCP parameter of the test in linear model is well known to be proportional to the sample size and the variance captured by the genotype (see also Section 2.2.1). \\[\\begin{equation} NCP_{unrel} \\approx \\hat{\\beta}_g^2 \\delta_g^2 n = \\hat{\\beta}_g^2 2 p (1 - p) n \\tag{1.3} \\end{equation}\\] When the individuals are genetically related and/or the covariance of the phenotype is modeled using structured relationship matrices among individuals, the following linear mixed model is stated, \\(y \\sim \\mathcal{N} (\\mu x_0 + \\beta_g x_g, \\sum_{k=1}^{m}{\\sigma_k^2 R_k} + \\sigma_r^2 I)\\). The initial step in solving a linear mixed model is to estimate random effects parameters (\\(\\sigma_k^2\\) and \\(\\sigma_r^2\\)) by restricted maximum likelihood (REML) or other optimization technique (Lynch and Walsh 1998). Once the estimate of the variance-covariance matrix is found, \\(\\hat{V} = \\sum{\\hat{\\sigma}_i^2 R_i} + \\hat{\\sigma}_r^2 I\\), the generalized least squares (GLS) for fixed effects are applied in the following matrix form, \\(\\hat{\\beta} = (X^T \\hat{V}^{-1} X)^{-1} X \\hat{V}^{-1} y\\). In Section 2.2.2 we derived the estimate of \\(\\beta_g\\) and its variance, \\(\\hat{\\beta}_g = (\\tilde{x}_g^T \\hat{V}^{-1} \\tilde{x}_g)^{-1} \\tilde{x}_g^T \\hat{V}^{-1} \\tilde{y}\\) and \\(var(\\hat{\\beta_g}) = 1 / (\\tilde{x}_g^T \\hat{V}^{-1} \\tilde{x}_g)\\), respectively. We further approximated the term \\(\\tilde{x}_g^T \\hat{V}^{-1} \\tilde{x}_g\\) using the expected mean of a quadratic form of the random variable \\(\\mathcal{\\tilde{X}_g}\\) and the transformation matrix \\(\\hat{V}^{-1}\\) (see Equation (2.1)). The NCP parameter of the test in linear mixed model has the following form, where \\(tr\\) denote the trace operator. \\[\\begin{equation} NCP_{rel} \\approx \\hat{\\beta}_g^2 tr(\\hat{V}^{-1} \\Sigma_g) = \\hat{\\beta}_g^2 \\delta_g^2 tr(\\hat{V}^{-1} K) = \\hat{\\beta}_g^2 2 p (1 - p) tr(\\hat{V}^{-1} K) \\tag{1.4} \\end{equation}\\] The effective size multiplier, defined as \\(NCP_{rel} / NCP_{unrel} = tr(\\hat{V}^{-1} K) / n\\), gives a quantitative assessment of gain or loss in power when comparing the study design of related and unrelated individuals. We further expand Equation (1.4) for two specific cases of (i) related individuals in families; (ii) unrelated individuals under the the infinite-testimal model. We also make use of the connection between the trace operator and eigen-value decomposition (Section 2.1). For individuals in families and the model \\(y \\sim \\mathcal{N} (\\mu x_0 + \\beta_g x_g, \\sigma_k^2 K + \\sigma_r^2 I))\\), we have an updated formula of \\(NCP_{ref}\\). \\[\\begin{equation} \\begin{split} NCP_{fam} &amp; = \\hat{\\beta}_g^2 2 p (1 - p) tr( (\\hat{\\sigma}_k^2 K + \\hat{\\sigma}_r^2 I)^{-1} K ) \\\\ &amp; = \\hat{\\beta}_g^2 2 p (1 - p) tr( (\\hat{\\sigma}_k^2 I + \\hat{\\sigma}_r^2 K^{-1})^{-1} ) \\\\ &amp; = \\hat{\\beta}_g^2 2 p (1 - p) \\sum_{i=1}^{n}{(\\hat{\\sigma}_k^2 + \\hat{\\sigma}_r^2 (\\lambda_{K}^i)^{-1})^{-1}} \\end{split} \\tag{1.5} \\end{equation}\\] When modeling the polygenic effect in unrelated individuals using the genetic relationship matrix (GRM) (denoted as \\(M\\) in equations) \\(y \\sim \\mathcal{N} (\\mu x_0 + \\beta_g x_g, \\sigma_m^2 M + \\sigma_r^2 I))\\), we rewrite \\(NCP_{ref}\\) as following. \\[\\begin{equation} \\begin{split} NCP_{unrel+grm} &amp; = \\hat{\\beta}_g^2 2 p (1 - p) tr( (\\hat{\\sigma}_k^2 M + \\hat{\\sigma}_r^2 I)^{-1} ) \\\\ &amp; = \\hat{\\beta}_g^2 2 p (1 - p) \\sum_{i=1}^{n}{(\\hat{\\sigma}_m^2 \\lambda_{M}^i + \\hat{\\sigma}_r^2)^{-1}} \\end{split} \\tag{1.6} \\end{equation}\\] 1.2.3 Testing gene-environment interaction effect The gene-environment interaction effect on phenotype in unrelated individuals is evaluated under the standard linear model \\(y \\sim \\mathcal{N} (\\mu x_0 + \\beta_g x_g + \\beta_e x_e + \\beta_{ge} x_{ge}, \\sigma_r^2 I)\\), where \\(x_0 = 1_n\\) is a vector of \\(n\\) ones, \\(\\mu\\) is a mean of the phenotypic values, \\(x_g\\) is a vector of length of the genotypic values, \\(\\beta_g\\) is the effect size of the genotype, \\(x_e\\) is a environment exposure vector of length \\(n\\), \\(\\beta_e\\) is the effect size of the environment exposure, \\(x_{ge}\\) is a vector of length \\(n\\) of gene-environment interaction, \\(\\beta_{ge}\\) is the interaction effect size. The coding scheme of the genotypic and environmental variables to study gene-environment interaction under linear model is important and has been reviewed elsewhere (Aschard 2016). Here, we work with centered variables \\(\\tilde{x}_g\\) and \\(\\tilde{x}_e\\) and define the interaction variable \\(\\tilde{x}_{ge}\\) by (i) element-wise multiplication of the two variables, (ii) centering the resulted product. Once the covariates are centered as described above, the effect sizes and their standard errors can be estimated independently from other covariates if we assume that the two random variables of genotype and environmental exposure are generated independently (Aschard 2016, Appendix C). We also note that different coding schemes give different estimates of effect sizes, but the test statistic for gene-environment interaction (\\(NCP\\)) is the same (Aschard 2016, Appendix B). We first need to define two matrices \\(E\\) and \\(D\\). The matrix \\(E\\) is related to the environment exposure (centered) vector \\(\\tilde{x}_e\\): \\(E\\) is the diagonal matrix with values equal to those observed in \\(\\tilde{x}_e\\), i.e. \\(diag(E) = \\tilde{x}_e\\). We also introduce a matrix \\(D\\), which value at row \\(i\\) and column \\(j\\) is equal to the product of two diagonal entries \\(i\\) and \\(j\\) of \\(E\\), i.e. \\(D_{i,j} = E_{i,i} E_{j,j}\\). When the environmental exposure is binary and the observed frequency of exposure is \\(f\\), then we denote the matrices as \\(E_b\\) and \\(D_b\\). Then the values on diagonal of the matrix \\(E_b\\) are either \\(-f\\) or \\(1 - f\\), while values of the matrix \\(D_b\\) are either \\(f^2\\), \\((1 - f)^2\\) or \\(f (1 - f)\\). Then the NCP parameter of the test in linear model has the following form (see Section 2.2.5). \\[\\begin{equation} NCP_{unrel}^i \\approx \\hat{\\beta}_{ge}^2 \\delta_g^2 tr(E_b^2) = \\hat{\\beta}_{ge}^2 2 p (1 - p) f (1 - f) n \\tag{1.7} \\end{equation}\\] When the individuals are genetically related and/or relationships among individuals are modeled, we again use the linear mixed model \\(y \\sim \\mathcal{N} (\\mu x_0 + \\beta_g x_g + \\beta_e x_e + \\beta_{ge} x_{ge}, \\sum_{k=1}^{m}{\\sigma_k^2 R_k} + \\sigma_r^2 I)\\). In Section 2.2.5 we derived the estimate of \\(\\beta_{ge}\\) and its variance for linear mixed model, \\(\\hat{\\beta}_{ge} = (\\tilde{x}_{ge}^T \\hat{V}^{-1} \\tilde{x}_{ge})^{-1} \\tilde{x}_{ge}^T \\hat{V}^{-1} \\tilde{y}\\) and \\(var(\\hat{\\beta_{ge}}) = 1 / (\\tilde{x}_{ge}^T \\hat{V}^{-1} \\tilde{x}_{ge})\\), respectively. As \\(\\tilde{x}_{ge}\\) is a realization of a random variable \\(\\mathcal{\\tilde{X}}_{ge} = E \\mathcal{\\tilde{X}}_{g}\\), we showed that \\(var(\\mathcal{\\tilde{X}}_{ge}) = \\delta_g^2 D \\circ K\\). Here, we introduce a special kinship matrix \\(K_{D}\\) “masked” by the (observed) environmental exposure though the matrix \\(D\\) (the operator \\(\\circ\\) denotes the Hadamard product, i.e. the element-wise multiplication). \\[\\begin{equation} \\begin{split} K_{D} = D \\circ K \\end{split} \\tag{1.8} \\end{equation}\\] In Section 2.2.5 we further approximated the term \\(\\tilde{x}_{ge}^T \\hat{V}^{-1} \\tilde{x}_{ge}\\) by applying the expression for the mean of a quadratic form of the random variable \\(\\mathcal{\\tilde{X}_{ge}}\\) and the transformation matrix \\(\\hat{V}^{-1}\\) (see Equation (2.1)). The NCP parameter of the test in linear mixed model has the following form. \\[\\begin{equation} NCP_{rel}^i \\approx \\hat{\\beta}_{ge}^2 \\delta_g^2 tr(\\hat{V}^{-1} K_{D}) = \\hat{\\beta}_{ge}^2 2 p (1 - p) tr(\\hat{V}^{-1} K_{D}) \\tag{1.9} \\end{equation}\\] The \\(K_{D}\\) matrix is equal to the \\(E^2\\) matrix in the case of genetically unrelated individuals (\\(K = I\\)), and the two formulas (1.9) and (1.7) become the same. We also note that the variance of the environmental exposure is contained within the matrices \\(K_{D}\\) and \\(E^2\\), although it is possible to similarly define the scaled matrices. TODO: \\(V = \\sigma^2_k K + \\sigma^2_i K_i + \\sigma^2_r I\\) (Sul et al. 2016) 1.3 Results 1.3.1 Analytical results for testing marginal genetic effect Table 1.1: Analytical comparison of study designs to detect marginal genetic association. Study designs differ in individual relationships that informs modeling of outcome (\\(y\\)) and distribution of genotype under association test (\\(x_g\\)). Study designs under comparison include: unrelated individuals; related individuals in families; unrelated individuals with a grouping factor such as house-hold (not related to a variable under test). Notation: \\(\\tilde{x_g}\\), mean-centered genotype vector \\(x_g\\); \\(\\delta_g^2 = 2 p (1 - p)\\), the variance of genotype random variable with the minor allele frequency \\(p\\); \\(K\\), the additive kinship matrix for family-based study design; \\(NCP\\), the non-centrality parameter of the test; \\(\\hat{V}\\), the estimated variance-covariance matrix of \\(y\\). Study design \\(V = Var(y)\\) \\(\\Sigma_g = Var(x_g)\\) \\(NCP\\) Unrelated \\(\\sigma_r^2 I\\) \\(\\delta_g^2 I\\) \\(\\hat{\\beta}^2_g (\\tilde{x_g}^T \\tilde{x_g}) \\approx \\hat{\\beta}^2_g \\delta_g^2 n\\) Families \\(\\sigma_k^2 K + \\sigma_r^2 I\\) \\(\\delta_g^2 K\\) \\(\\hat{\\beta}^2_g (\\tilde{x_g}^T \\hat{V}^{-1} \\tilde{x_g}) \\approx \\hat{\\beta}^2_g \\delta_g^2 \\mbox { } tr(\\hat{V}^{-1} K)\\) Unrelated + Grouping \\(\\sigma_h^2 H + \\sigma_r^2 I\\) \\(\\delta_g^2 I\\) \\(\\hat{\\beta}^2_g (\\tilde{x_g}^T \\hat{V}^{-1} \\tilde{x_g}) \\approx \\hat{\\beta}^2_g \\delta_g^2 \\mbox { } tr(\\hat{V}^{-1})\\) Figure 1.1: Three study designs are compared in terms of power to detect marginal genetic effect under the model \\(y \\sim \\mathcal{N}(\\mu + \\beta_g x_g, V)\\) (see also Table 1.1). The reference study design “Unrelated” with \\(V = \\sigma^2_r I\\) is; the study Two study designs with a structured variance components, unrelated individuals with a non-genetic grouping factor and related individuals in families, are compared to the reference study design of unrelated individuals. The performance is evaluated to To make the study designs comparable, the sum of variance components in the \\(V\\) matrix is equal to one. (a) The effective size multiplier, estimated as \\(tr(V^{-1} \\Sigma_g) / n\\), depends on the variance explained. (b) When the variance explained fixed to 50% and the sample size varies, Notation: \\(n\\), the sample size. Ref 1.1 1.3.2 Analytical results for testing gene-environment interaction effect Figure 1.2: Comparison of study designs to detect interaction effect. Ref 1.2 1.3.3 Implication in association studies References "],
["supplementary-material.html", "2 Supplementary Material 2.1 Propositions 2.2 Analytical derivations 2.3 Simulations 2.4 Supplementary Figures", " 2 Supplementary Material 2.1 Propositions Quadratic form: If \\(\\mathcal{X}\\) is a vector of random variables with mean \\(\\mu\\) and (nonsingular) covariance matrix \\(\\Sigma\\), then the quadratic form \\(\\mathcal{X}^T A \\mathcal{X}\\) is a scalar random variable: \\[\\begin{equation} E(\\mathcal{X}^T A \\mathcal{X}) = tr(A\\Sigma) + \\mu^T \\Sigma \\mu \\tag{2.1} \\end{equation}\\] \\[\\begin{equation} Var(\\mathcal{X}^T A \\mathcal{X}) = 2tr(A \\Sigma A \\Sigma) + 4\\mu A \\Sigma A \\mu \\tag{2.2} \\end{equation}\\] See (Lynch and Walsh 1998, Appendix 3, pp. 843) for more details. A linear transform of a random vector: If \\(B\\) is a constant matrix and \\(\\mathcal{X}\\) is a vector of random variables with mean \\(\\mu\\) and covariance matrix \\(\\Sigma\\), then \\(B \\mathcal{X}\\) is a vector of random variables: \\[\\begin{equation} E(B \\mathcal{X}) = B E(\\mathcal{X}) \\tag{2.3} \\end{equation}\\] \\[\\begin{equation} Var(B \\mathcal{X}) = B Var(\\mathcal{X}) B^T \\tag{2.4} \\end{equation}\\] The proof makes use of definitions of mean and variance. Eigen-value decompostion (EVD): If \\(K\\) is the covariane matrix of size \\(n \\times n\\), that means \\(K\\) is symmetric and positive semi-definite. Furthemore, EVD of \\(K\\) is \\[\\begin{equation} K = Q D Q^T = Q D Q^{-1} \\tag{2.5} \\end{equation}\\] where \\(Q\\) is an \\(n \\times n\\) orthogonal matrix of eigen-vectors and \\(D\\) is a \\(n \\times n\\) diagonal matirx of eigen-values (\\(\\lambda_{K}^i\\) with \\(i\\) from 1 to \\(n\\)). EVD for the matrix inverse to \\(K\\) is \\[\\begin{equation} K^{-1} = Q D^{-1} Q^T \\tag{2.6} \\end{equation}\\] EVD for the matrix such as \\(V = a K + b I\\), where \\(a\\) and \\(b\\) are scalars, \\(I\\) is the \\(n \\times n\\) identity matrix, is \\[\\begin{equation} V = a K + b I = a Q D Q^T + b I = a Q D Q^T + b Q I Q^T = Q (a K + b I) Q^T \\tag{2.6} \\end{equation}\\] Eigen-value decompostion (EVD) and the trace operator: For the covariance matrix \\(K\\) and the matrix \\(V = a K + b I\\), we have the following serie of equation in relation to the trace operator. \\[\\begin{equation} \\begin{split} tr(K) &amp; = \\sum_{i=1}^{n}{\\lambda_{K}^i} \\\\ tr(K^{-1}) &amp; = \\sum_{i=1}^{n}{(\\lambda_{K}^i)^{-1}} \\\\ tr(V) = tr(a K + b I) &amp; = \\sum_{i=1}^{n}{(a \\lambda_{K}^i + b)} \\\\ tr(V^{-1}) = tr((a K + b I)^{-1}) &amp; = \\sum_{i=1}^{n}{(a \\lambda_{K}^i + b)^{-1}} \\\\ tr(V^{-1} K) = tr((a K + b I)^{-1} K) = tr((a I + b K^{-1})^{-1}) &amp; = \\sum_{i=1}^{n}{(a + b (\\lambda_{K}^i)^{-1})^{-1}} \\end{split} \\tag{2.7} \\end{equation}\\] In the last equation we used the following equality. \\[\\begin{equation} \\begin{split} V^{-1} K &amp; = (a K + b I)^{-1} K = (a K + b I)^{-1} (K^{-1})^{-1} \\\\ &amp; = K^{-1} (a K + b I)^{-1} = (a I + b K^{-1})^{-1} \\end{split} \\tag{2.8} \\end{equation}\\] 2.2 Analytical derivations To study the impact of relatedness among individuals on modeling a continuous phenotype \\(y\\), we consider the following linear mixed model: \\[\\begin{equation} y = X \\beta + \\sum_{k=1}^{m}{r_k} + e \\tag{2.9} \\end{equation}\\] where \\(n\\) is the number of individuals, \\(p\\) is the number of covariates or fixed effects, \\(m\\) is the number of structured random effects apart from the residuals errors, \\(y\\) is a phenotype vector of length \\(n\\), \\(X\\) is a matrix of covariates of size \\(n \\times p\\), \\(\\beta\\) is a vector of fixed effects of length \\(p\\). The vectors of random effects \\(r_k\\) and \\(e\\) are mutually uncorrelated and multivariate normally distributed as \\(\\mathcal{N}(0, \\sigma^2_k R_k)\\) and \\(\\mathcal{N}(0, \\sigma^2_r I)\\). The variance-covariance matrices are parametrized with scalar parameters and constant matrices of size \\(n \\times n\\) that express relationships among \\(n\\) individuals. The first \\(m\\) random effects \\(r_k\\) are referred here as structured, whereas the last component \\(e\\) is simply the residual errors which are independent and identically distributed. Thus, the phenotype follows a multivariate normal distribution (MVN) and Equation (2.9) can be rewritten: \\[\\begin{equation} y \\sim \\mathcal{N} (X \\beta, V) = \\mathcal{N} (X \\beta, \\sum_{k=1}^{m}{\\sigma_k^2 R_k} + \\sigma_r^2 I) \\tag{2.10} \\end{equation}\\] We further consider several parameterizations of the model in Equation (2.10) that depend on (i) whether marginal genetic or gene-environment interaction effect is under testing; (ii) whether structured random effects are included or only the residual errors. Consequently, the composition of fixed and random effects are updated accordingly via the matrices \\(X\\) and \\(V\\), respectively. 2.2.1 Testing marginal genetic effect in unrelated individuals We rewrite Equation (2.10) as following: \\[\\begin{equation} y \\sim \\mathcal{N} (X \\beta, V) = \\mathcal{N} (\\mu x_0 + \\beta_g x_g, \\sigma_r^2 I) \\tag{2.11} \\end{equation}\\] where \\(x_0 = 1_n\\) is a vector of \\(n\\) ones, \\(\\mu\\) is a mean of the phenotypic values, \\(x_g\\) is a vector of length of the genotypic values, \\(\\beta_g\\) is the effect size of the genotype. The ordinary least squares (OLS) solution for fixed effects is the following in the matrix form, \\(\\hat{\\beta} = (X^T X)^{-1} X y\\). Further, the effect \\(\\beta_g\\) can be estimated separately from the mean effect \\(\\mu\\) if vectors \\(y\\) and \\(x_g\\) are centered and, thus, the two vectors are uncorrelated. Hence, the estimated effect is expressed as \\(\\hat{\\beta_g} = (\\tilde{x}_g^T \\tilde{x}_g)^{-1} \\tilde{x}_g \\tilde{y}\\), where \\(\\tilde{x}_g\\) and \\(\\tilde{y}\\) are centered vectors \\(x_g\\) and \\(y\\), respectively. The variance of the estimate is \\(var(\\hat{\\beta_g}) = \\sigma_r^2 / (\\tilde{x}_g^T \\tilde{x}_g)\\) and the final expression is the following: \\[\\begin{equation} \\hat{\\beta}_g = (\\tilde{x}_g^T \\tilde{x}_g)^{-1} \\tilde{x}_g^T \\tilde{y} \\sim \\mathcal{N} (\\beta_g, \\sigma_r^2 / (\\tilde{x}_g^T \\tilde{x}_g)) \\tag{2.12} \\end{equation}\\] We next approximate the expression \\(\\tilde{x}_g^T \\tilde{x}_g\\) by using the fact that that \\(x_g\\) is a realization of a vector of random variables \\(\\mathcal{X_g}\\), which is a genotype in \\(n\\) unrelated individuals with a minor allele frequency \\(p\\). Consequently, we denote \\(\\mathcal{X_g} \\sim (\\mu_g, \\Sigma_g) = (p 1_n, \\delta_g^2 I) = (p 1_n, 2 p (1-p) I)\\) and also \\(\\mathcal{\\tilde{X}_g} \\sim (0_n, \\Sigma_g)\\), where \\(I\\) is the identity matrix of size \\(n \\times n\\), \\(1_n\\) is a vector of \\(n\\) ones and \\(0_n\\) is a vector of \\(n\\) zeros. Applying the proposition for quadratic forms in Equation (2.2) for \\(\\mathcal{\\tilde{X}_g}\\), we obtain the approximation: \\[\\begin{equation} \\tilde{x}_g^T \\tilde{x}_g \\approx E(\\mathcal{\\tilde{X}_g}^T \\mathcal{\\tilde{X}_g}) = tr(\\delta_g^2 I) = \\delta_g^2 n = 2 p (1 - p) n \\tag{2.13} \\end{equation}\\] The NCP parameter for testing the marginal genetic effect in unrelated individuals is approximated as following: \\[\\begin{equation} NCP_{unrel} = \\hat{\\beta}_g^2 / var(\\hat{\\beta}_g) \\approx \\hat{\\beta}_g^2 \\delta_g^2 n / \\sigma_r^2 = \\hat{\\beta}_g^2 2 p (1 - p) n / \\sigma_r^2 \\tag{2.14} \\end{equation}\\] If the the phenotype \\(y\\) is standardized, i.e. \\(var(y) = 1\\) and the effect \\(\\beta_g\\) is small, then we can further approximate \\(\\sigma_r^2 \\approx 1\\) based on the following: \\[\\begin{equation} \\begin{split} \\sigma^2_r &amp; \\approx \\hat{\\sigma}^2_r = \\hat{e}^T \\hat{e} / (n - 2) \\\\ &amp; = (\\tilde{y} - \\hat{\\beta}_g \\tilde{x})^T (\\tilde{y} - \\hat{\\beta}_g \\tilde{x}) / (n - 2) \\approx \\tilde{y}^T \\tilde{y} / (n - 2) \\approx 1 \\end{split} \\tag{2.15} \\end{equation}\\] Hence, we obtain the NCP estimation for the scaled phenotype: \\[\\begin{equation} NCP_{unrel} = \\hat{\\beta}_g^2 / var(\\hat{\\beta}_g) \\approx \\hat{\\beta}_g^2 \\delta_g^2 n = \\hat{\\beta}_g^2 2 p (1 - p) n \\tag{2.14} \\end{equation}\\] 2.2.2 Testing marginal genetic effect in related individuals We rewrite Equation (2.10) as following: \\[\\begin{equation} y \\sim \\mathcal{N} (X \\beta, V) = \\mathcal{N} (\\mu x_0 + \\beta_g x_g, \\sum_{k=1}^{m}{\\sigma_k^2 R_k} + \\sigma_r^2 I) \\tag{2.16} \\end{equation}\\] The initial step in solving a linear mixed model is to estimate random effects parameters (\\(\\sigma_k^2\\) and \\(\\sigma_r^2\\)) by maximum likelihood (ML), restricted maximum likelihood (REML) or other optimization technique (Lynch and Walsh 1998). Once the estimate of the variance-covariance matrix is found, \\(\\hat{V} = \\sum{\\hat{\\sigma}_i^2 R_i} + \\hat{\\sigma}_r^2 I\\), the generalized least squares (GLS) solution for fixed effects is applied in the following matrix form, \\(\\hat{\\beta} = (X^T \\hat{V}^{-1} X)^{-1} X \\hat{V}^{-1} y\\). This solution is obvious if both parts of Equation (2.16) are multiplied by \\(\\hat{V}^{-0.5}\\), thus removing the correlation structure in the random part. \\[\\begin{equation} \\hat{V}^{-0.5} y \\sim \\mathcal{N} (\\mu \\hat{V}^{-0.5} x_0 + \\beta_x \\hat{V}^{-0.5} x , I) \\tag{2.17} \\end{equation}\\] The expression for the genetic effect estimate is obtained similarly to Equation (2.12) and working with centered vectors: \\[\\begin{equation} \\hat{\\beta}_g = (\\tilde{x}_g^T \\hat{V}^{-1} \\tilde{x}_g)^{-1} \\tilde{x}_g^T \\hat{V}^{-1} \\tilde{y} \\sim \\mathcal{N} (\\beta_g, 1 / (\\tilde{x}_g^T \\hat{V}^{-1} \\tilde{x}_g)) \\tag{2.18} \\end{equation}\\] We further again consider the quadratic form \\(\\tilde{x}_g^T \\hat{V}^{-1} \\tilde{x}_g\\) and use its mean for approximation, as shown in Equation (2.2). A vector \\(x_g\\) of the genotypic values is a realization of a vector of random variables \\(\\mathcal{X_g} \\sim (\\mu_g, \\Sigma_g) = (p 1_n, \\delta_g^2 K) = (p 1_n, 2 p (1 - p) K)\\), where \\(p\\) is a minor allele frequency of the genotype and \\(K\\) is the kinship matrix of size \\(n \\times n\\). We also introduce a centered vector of random variables \\(\\mathcal{X_g} \\sim (0_n, \\Sigma_g)\\). The matrix \\(K\\) expresses the genetic relatedness among \\(n\\) individuals and it is the identity matrix \\(I\\) for genetically unrelated individuals. The derivation presented here are appropriate for any form of the matrix \\(K\\). Treating the matrix \\(\\hat{V}^{-1}\\) as a (constant) transformation matrix \\(A\\) in Equation (2.2) for quadratic forms gives us the approximation: \\[\\begin{equation} \\tilde{x}_g^T \\hat{V}^{-1} \\tilde{x}_g \\approx E(\\mathcal{\\tilde{X}_g}^T \\hat{V}^{-1} \\mathcal{\\tilde{X}_g}) = tr(\\hat{V}^{-1} \\Sigma_g) = \\delta_g^2 tr(\\hat{V}^{-1} K) = 2 p (1 - p) tr(\\hat{V}^{-1} K) \\tag{2.19} \\end{equation}\\] The NCP parameter for testing the marginal genetic effect in related individuals is approximated as following: \\[\\begin{equation} \\begin{split} NCP_{rel} &amp; = \\hat{\\beta}_g^2 / var(\\hat{\\beta}_g) \\approx \\hat{\\beta}_g^2 tr(\\hat{V}^{-1} \\Sigma_g) \\\\ &amp; = \\hat{\\beta}_g^2 \\delta_g^2 tr(\\hat{V}^{-1} K) = \\hat{\\beta}_g^2 2 p (1 - p) tr(\\hat{V}^{-1} K) \\end{split} \\tag{2.14} \\end{equation}\\] 2.2.3 Effective size multiplier for testing marginal genetic effect We joint results from the previous two sections 2.2.1 and 2.2.2 to derive the formula for ratio between \\(NCP_{rel}\\) and \\(NCP_{unrel}\\), as referred herein the effective size multiplier. \\[\\begin{equation} NCP_{rel} / NCP_{unrel} = tr(\\hat{V}^{-1} K) / (n / \\sigma^2_r) \\tag{2.20} \\end{equation}\\] If the variance of the phenotype \\(y\\) is standardized to 1 and the variance captured by the genotype is small, then we can approximate \\(\\sigma_r^2 \\approx 1\\) in Equation (2.14) and further obtain: \\[\\begin{equation} NCP_{rel} / NCP_{unrel} = tr(\\hat{V}^{-1} K) / n \\tag{2.21} \\end{equation}\\] The variance components in \\(\\hat{V}\\) are then considered as the proportions, since the variance of the phenotype \\(y\\) is standardized to 1. 2.2.4 Testing gene-environment interaction effect in unrelated individuals We rewrite Equation (2.10) as following: \\[\\begin{equation} y \\sim \\mathcal{N} (X \\beta, V) = \\mathcal{N} (\\mu x_0 + \\beta_g x_g + \\beta_e x_e + \\beta_{ge} x_{ge}, \\sigma_r^2 I) \\tag{2.22} \\end{equation}\\] where \\(x_0 = 1_n\\) is a vector of \\(n\\) ones, \\(\\mu\\) is a mean of the phenotypic values, \\(x_g\\) is a genotype vector of length \\(n\\), \\(\\beta_g\\) is the effect size of the genotype, \\(x_e\\) is a environment exposure vector of length \\(n\\), \\(\\beta_e\\) is the effect size of the environment exposure, \\(x_{ge}\\) is a vector of length \\(n\\) of gene-environment interaction, \\(\\beta_{ge}\\) is the interaction effect size. The coding scheme of the genotypic and environmental variables to study gene-environment interaction under the standard linear model has been reviewed elsewhere (Aschard 2016). Here, we work with centered variables \\(\\tilde{x}_g\\) and \\(\\tilde{x}_e\\), and define the interaction variable \\(\\tilde{x}_{ge}\\) by (i) element-wise multiplication of the two variables denoted as \\(\\ddot{x}_{ge} = \\tilde{x}_g \\circ \\tilde{x}_e\\), (ii) centering the resulted product \\(\\ddot{x}_{ge}\\). Hence, the effect size for each variable (columns in \\(X\\)) can be estimated independently from the other variables under assumption that the two random variables of genotype and environmental exposure are independent (Aschard 2016, Appendix C). Of a note, different coding schemes give different estimates of effect sizes, but the test statistic for gene-environment interaction is the same (Aschard 2016, Appendix B). Therefore, the estimate of interest \\(\\hat{\\beta}_{ge}\\) has the following distribution: \\[\\begin{equation} \\hat{\\beta}_{ge} = (\\tilde{x}_{ge}^T \\tilde{x}_{ge})^{-1} \\tilde{x}_{ge}^T \\tilde{y} \\sim \\mathcal{N} (\\beta_{ge}, \\sigma_r^2 / (\\tilde{x}_{ge}^T \\tilde{x}_{ge})) \\tag{2.23} \\end{equation}\\] To further approximate the quantity \\(\\tilde{x}_{ge}^T \\tilde{x}_{ge}\\), we need to work with two random variables. The first one is a vector of random variables \\(\\mathcal{\\tilde{X}_g} \\sim (0_n, \\Sigma_g) = (0_n, \\delta_g^2 I) = (0_n, 2 p (1-p) I)\\), which we previously described. The second is a vector of random variables \\(\\mathcal{\\tilde{X}}_{ge} = \\tilde{x}_e \\circ \\mathcal{\\tilde{X}}_g = E \\mathcal{\\tilde{X}}_g\\), which is a transformed variable of \\(\\mathcal{\\tilde{X}_g}\\) with the transformation matrix \\(E = \\mathrm{diag}(\\tilde{x}_e)\\), defined as a diagonal matrix with values equal to those observed in the environmental exposure. The operator \\(\\circ\\) denotes the element-wise multiplication (the Hadamard product). We also consider a simple case for the environmental exposure when it is binary and the observed frequency of exposure is \\(f\\). Then the values on diagonal of the matrix \\(E\\) are equal \\(-f\\) and \\(1 - f\\), and we denote this matrix as \\(E_b\\). We further give an example of the matrix \\(E_b\\) for 5 individuals under study with the first two unexposed and the last three exposed to the environment, i.e. \\(f = 0.6\\). \\[\\begin{equation*} E_b = \\left(\\begin{array}{ccccc} 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\\\ 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\\\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1\\\\ \\end{array}\\right) - \\left(\\begin{array}{c} 0.6 \\\\ 0.6 \\\\ 0.6 \\\\ 0.6 \\\\ 0.6 \\\\ \\end{array}\\right) = \\left(\\begin{array}{ccccc} -0.6 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\\\ 0 &amp; -0.6 &amp; 0 &amp; 0 &amp; 0\\\\ 0 &amp; 0 &amp; 0.4 &amp; 0 &amp; 0\\\\ 0 &amp; 0 &amp; 0 &amp; 0.4 &amp; 0\\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.4\\\\ \\end{array}\\right) \\end{equation*}\\] We first need to derive the variance of the random variable \\(\\mathcal{\\tilde{X}}_{ge}\\). We obtain from Equation (2.4): \\[\\begin{equation} \\begin{split} \\mathrm{Var}(\\mathcal{\\tilde{X}}_{ge}) &amp; = \\mathrm{Var}(E \\mathcal{\\tilde{X}}_g) = E \\mathrm{Var}(\\mathcal{\\tilde{X}}_g) E^T \\\\ &amp; = E (\\delta_g^2 I) E^T = \\delta_g^2 E E^T = \\delta_g^2 E^2 \\end{split} \\tag{2.24} \\end{equation}\\] Applying the results for quadratic forms in Equation (2.2) gives us the approximation: \\[\\begin{equation} \\tilde{x}_{ge}^T \\tilde{x}_{ge} \\approx E(\\mathcal{\\tilde{X}}_{ge}^T \\mathcal{\\tilde{X}}_{ge}) = tr(\\delta_g^2 E^2) = \\delta_g^2 tr(E^2) = 2 p (1 - p) tr(E^2) \\tag{2.13} \\end{equation}\\] When the exposure is binary, we can simplify this quantity using the following equality \\(tr(E_b) = f (1 - f) n\\): \\[\\begin{equation} \\tilde{x}_{ge}^T \\tilde{x}_{ge} \\approx \\delta_g^2 f (1 - f) n = 2 p (1 - p) f (1 - f) n \\tag{2.25} \\end{equation}\\] Next, the NCP parameter for testing the gene-environment interaction effect in unrelated individuals is approximated as following: \\[\\begin{equation} NCP_{unrel + int} = \\hat{\\beta}_{ge}^2 / var(\\hat{\\beta}_{ge}) \\approx \\hat{\\beta}_{ge}^2 \\delta_g^2 tr(E^2) / \\sigma_r^2 = \\hat{\\beta}_{ge}^2 2 p (1 - p) tr(E^2) / \\sigma_r^2 \\tag{2.26} \\end{equation}\\] When the exposure is binary: \\[\\begin{equation} NCP_{unrel + int} = \\hat{\\beta}_{ge}^2 / var(\\hat{\\beta}_{ge}) \\approx \\hat{\\beta}_{ge}^2 \\delta_g^2 tr(E_b^2) / \\sigma_r^2 = \\hat{\\beta}_{ge}^2 2 p (1 - p) f (1 - f) n / \\sigma_r^2 \\tag{2.27} \\end{equation}\\] Additionally, we approximate \\(\\sigma_r^2 \\approx 1\\) if the the phenotype \\(y\\) is standardized and the variance captured by all genetic, environmental and interaction effects is small. 2.2.5 Testing gene-environment interaction effect in related individuals We rewrite Equation (2.10) as following: \\[\\begin{equation} y \\sim \\mathcal{N} (X \\beta, V) = \\mathcal{N} (\\mu x_0 + \\beta_g x_g + \\beta_e x_e + \\beta_{ge} x_{ge}, \\sum_{k=1}^{m}{\\sigma_k^2 R_k} + \\sigma_r^2 I) \\tag{2.28} \\end{equation}\\] As in the previous derivation in Section 2.2.4, we apply the same coding scheme for genetic, environmental and gene-environmental interaction variables, \\(\\tilde{x}_g\\), \\(\\tilde{x}_e\\) and \\(\\tilde{x}_{ge}\\), respectively. As in the previous Section 2.2.2, we derive the distribution of \\(\\hat{\\beta}_{ge}\\) conditionally on the estimate of the variance-covariance matrix \\(\\hat{V} = \\sum{\\hat{\\sigma}_i^2 R_i} + \\hat{\\sigma}_r^2 I\\): \\[\\begin{equation} \\hat{\\beta}_{ge} = (\\tilde{x}_{ge}^T \\hat{V}^{-1} \\tilde{x}_{ge})^{-1} \\tilde{x}_{ge}^T \\hat{V}^{-1} \\tilde{y} \\sim \\mathcal{N} (\\beta_{ge}, 1 / (\\tilde{x}_{ge}^T \\hat{V}^{-1} \\tilde{x}_{ge})) \\tag{2.29} \\end{equation}\\] Also as in the previous Section 2.2.2, we consider the two random vectors, \\(\\mathcal{\\tilde{X}_g} \\sim (0_n, \\Sigma_g) = (0_n, \\delta_g^2 K) = (0_n, 2 p (1-p) K)\\), and \\(\\mathcal{\\tilde{X}}_{ge} = \\tilde{x}_e \\circ \\mathcal{\\tilde{X}}_g = E \\mathcal{\\tilde{X}}_g\\). The later is a transformed variable of \\(\\mathcal{\\tilde{X}_g}\\) with the transformation matrix \\(E = \\mathrm{diag}(\\tilde{x}_e)\\), In addition, we introduce a matrix \\(D\\), which value at row \\(i\\) and column \\(j\\) is equal to the product of two diagonal entries \\(i\\) and \\(j\\) of \\(E\\), i.e. \\(D_{i,j} = E_{i,i} E_{j,j}\\). The use of this matrix \\(D\\) is explained below. When the environmental exposure is binary with the exposure frequency \\(f\\), we denote the matrix \\(E\\) as \\(E_b\\) and the matrix \\(D\\) as \\(D_b\\). The values on diagonal of \\(E_b\\) are either \\(f\\) or \\(1 - f\\), while the values of \\(D_b\\) are either \\(f^2\\), \\((1 - f)^2\\) or \\(f (1 - f)\\). We derive the variance of the random variable \\(\\mathcal{\\tilde{X}}_{ge}\\) using proposition in Equation (2.4): \\[\\begin{equation} \\begin{split} \\mathrm{Var}(\\mathcal{\\tilde{X}}_{ge}) &amp; = \\mathrm{Var}(E \\mathcal{\\tilde{X}}_g) = E \\mathrm{Var}(\\mathcal{\\tilde{X}}_g) E^T = E \\Sigma_g E^T \\\\ &amp; = \\delta_g^2 E K E^T = \\delta_g^2 D \\circ K = \\delta_g^2 K_{D} \\end{split} \\tag{2.30} \\end{equation}\\] In the second part of derivation, we again used the fact that the matrix \\(E\\) is diagonal; that means the expression \\(E A E^T\\) for a given matrix A can be rewritten as \\(D \\circ A\\), where the \\(D\\) was defined before and the operator \\(\\circ\\) denotes the element-wise multiplication (the Hadamard product). In Equation (2.30) we introduced a special kinship matrix \\(K_{D}\\) “masked” by the environmental exposure though the matrix \\(D\\) defined above. \\[\\begin{equation} \\begin{split} K_{D} = D \\circ K \\end{split} \\tag{2.31} \\end{equation}\\] We note that the \\(K_{D}\\) matrix becomes the \\(E^2\\) matrix in the previous section 2.2.4 when \\(K = I\\), i.e. the case of unrelated individuals. For an illustration example, we show how the matrices \\(E_b\\), \\(D_b\\), \\(K\\) and \\(K_{D}\\) look like for 5 individuals with the first two unexposed and the last three exposed to the environment, i.e. \\(f = 0.6\\). The five individuals represent a nuclear family of two parents and three children. \\[\\begin{equation*} E_b = \\left(\\begin{array}{ccccc} -0.6 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\\\ 0 &amp; -0.6 &amp; 0 &amp; 0 &amp; 0\\\\ 0 &amp; 0 &amp; 0.4 &amp; 0 &amp; 0\\\\ 0 &amp; 0 &amp; 0 &amp; 0.4 &amp; 0\\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0.4\\\\ \\end{array}\\right) \\end{equation*}\\] \\[\\begin{equation*} D_b = \\left(\\begin{array}{ccccc} -0.36 &amp; -0.36 &amp; -0.24 &amp; -0.24 &amp; -0.24\\\\ -0.36 &amp; -0.36 &amp; -0.24 &amp; -0.24 &amp; -0.24\\\\ -0.24 &amp; -0.24 &amp; 0.16 &amp; 0.16 &amp; 0.16\\\\ -0.24 &amp; -0.24 &amp; 0.16 &amp; 0.16 &amp; 0.16\\\\ -0.24 &amp; -0.24 &amp; 0.16 &amp; 0.16 &amp; 0.16\\\\ \\end{array}\\right) \\end{equation*}\\] \\[\\begin{equation*} K = \\left(\\begin{array}{ccccc} 1 &amp; 0 &amp; 0.5 &amp; 0.5 &amp; 0.5\\\\ 0 &amp; 1 &amp; 0.5 &amp; 0.5 &amp; 0.5\\\\ 0.5 &amp; 0.5 &amp; 1 &amp; 0.5 &amp; 0.5\\\\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 1 &amp; 0.5\\\\ 0.5 &amp; 0.5 &amp; 0.5 &amp; 0.5 &amp; 1\\\\ \\end{array}\\right) \\end{equation*}\\] \\[\\begin{equation*} K_{D_b} = \\left(\\begin{array}{ccccc} -0.36 &amp; 0 &amp; -0.12 &amp; -0.12 &amp; -0.12\\\\ 0 &amp; -0.36 &amp; -0.12 &amp; -0.12 &amp; -0.12\\\\ -0.12 &amp; -0.12 &amp; 0.16 &amp; 0.08 &amp; 0.08\\\\ -0.12 &amp; -0.12 &amp; 0.08 &amp; 0.16 &amp; 0.08\\\\ -0.12 &amp; -0.12 &amp; 0.08 &amp; 0.08 &amp; 0.16\\\\ \\end{array}\\right) \\end{equation*}\\] Further applying the proposition for quadratic forms in Equation (2.2) gives us the approximation: \\[\\begin{equation} \\begin{split} \\tilde{x}_{ge}^T \\hat{V}^{-1} \\tilde{x}_{ge} &amp; \\approx E(\\mathcal{\\tilde{X}}_{ge}^T \\hat{V}^{-1} \\mathcal{\\tilde{X}}_{ge}) = tr(\\hat{V}^{-1} \\delta_g^2 K_{D}) \\\\ &amp; = \\delta_g^2 tr(\\hat{V}^{-1} K_{D}) = 2 p (1 - p) tr(\\hat{V}^{-1} K_{D}) \\end{split} \\tag{2.32} \\end{equation}\\] The NCP parameter for testing the gene-environment interaction effect in related individuals is approximated as following: \\[\\begin{equation} NCP_{rel + int} = \\hat{\\beta}_{ge}^2 / var(\\hat{\\beta}_{ge}) \\approx \\hat{\\beta}_{ge}^2 \\delta_g^2 tr(\\hat{V}^{-1} K_{D}) = \\hat{\\beta}_{ge}^2 2 p (1 - p) tr(\\hat{V}^{-1} K_{D}) \\tag{2.33} \\end{equation}\\] 2.2.6 Effective size multiplier for testing marginal gene-environment interaction effect We joint results from the previous two sections 2.2.4 and 2.2.5 and present the formula for ratio between \\(NCP_{rel+int}\\) and \\(NCP_{unrel+int}\\), as referred herein the effective size multiplier. \\[\\begin{equation} NCP_{rel + int} / NCP_{unrel + int} = tr(\\hat{V}^{-1} K_{D}) / (tr(E^2) / \\sigma^2_r) \\tag{2.34} \\end{equation}\\] If the variance of the phenotype \\(y\\) is standardized to 1 and the variance captured by fixed effects is small, then we can approximate \\(\\sigma_r^2 \\approx 1\\) in Equation (2.26) and further obtain: \\[\\begin{equation} NCP_{rel + int} / NCP_{unrel + int} = tr(\\hat{V}^{-1} K_{D}) / tr(E^2) \\tag{2.35} \\end{equation}\\] The variance components in \\(\\hat{V}\\) are then considered as the proportions, since the variance of the phenotype \\(y\\) is standardized to 1. 2.3 Simulations 2.3.1 Unrelated: marginal genetic effect 2.3.2 Families: marginal genetic effect Sample Size Trace Factor 100 0.8253 500 0.8253 1,000 0.8253 2,000 0.8253 2.3.3 Unrelated: interaction effect 2.3.4 Familes (two genetic components): interaction effect Sample Size Trace Factor 100 1.1921 500 1.2219 1,000 1.2333 2,000 1.2598 2.3.5 Familes (one genetic component): interaction effect Sample Size Trace Factor 100 1.2848 500 1.2785 1,000 1.2653 2,000 1.2596 2.4 Supplementary Figures Figure 2.1: Influence of family structure to detect marginal genetic effect. Figure 2.2: Influence of family structure to detect interaction genetic effect. Figure 2.3: Influence of GxE variance component to detect interaction effect. References "],
["references.html", "References", " References "]
]
